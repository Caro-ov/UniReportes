<!DOCTYPE html>
<html lang="es">
<head>
    <!-- Head común -->
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>UniReportes - Mis Reportes</title>
    <link rel="icon" type="image/x-icon" href="favicon.ico"/>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com" rel="preconnect"/>
    <link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;900&family=Noto+Sans:wght@400;500;700;900&display=swap" rel="stylesheet"/>
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet"/>
    <!-- Precarga de CSS comunes para reducir retrasos -->
    <link rel="preload" href="css/dashboard.css" as="style" onload="this.onload=null;this.rel='stylesheet'"/>
    <link rel="preload" href="css/admin-dashboard.css" as="style" onload="this.onload=null;this.rel='stylesheet'"/>
    <link rel="preload" href="css/crear-reporte.css" as="style" onload="this.onload=null;this.rel='stylesheet'"/>
    <link rel="preload" href="css/perfil.css" as="style" onload="this.onload=null;this.rel='stylesheet'"/>
    <link rel="preload" href="css/ayuda.css" as="style" onload="this.onload=null;this.rel='stylesheet'"/>
    <!-- CSS - Cargado estáticamente para evitar retrasos -->
    <link rel="stylesheet" href="css/components.css"/>
    <link rel="stylesheet" href="css/mis-reportes.css"/>
    <link rel="stylesheet" href="css/responsive.css"/>
    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <!-- Script de seguridad -->
    <script>
    if (window.location.pathname !== '/login.html' && 
        window.location.pathname !== '/' && 
        !window.location.pathname.includes('index.html')) {
        if (sessionStorage.getItem('logout_flag')) {
            sessionStorage.removeItem('logout_flag');
            window.location.replace('/login.html');
        }
        window.addEventListener('pageshow', function(event) {
            if (event.persisted || sessionStorage.getItem('logout_flag')) {
                sessionStorage.removeItem('logout_flag');
                window.location.replace('/login.html');
            }
        });
    }
    </script>
</head>
<body data-page="mis-reportes" data-title="UniReportes - Mis Reportes" data-css="mis-reportes">
    <div class="contenedor-principal">
        <!-- Overlay para móvil -->
        <div class="overlay" onclick="toggleSidebar()"></div>
        
        <!-- Sidebar de navegación -->
        <aside id="sidebar-container" class="sidebar">
            <!-- Sidebar será cargado aquí -->
        </aside>

        <!-- Contenido wrapper -->
        <div class="contenido-wrapper">
            <!-- Header superior -->
            <header id="header-container" class="header-principal">
                <!-- Header será cargado aquí -->
            </header>

            <!-- Contenido principal -->
            <main class="contenido-principal">
            <div class="contenedor-contenido">
                <!-- Encabezado de la página -->
                <div class="encabezado-pagina">
                    <div class="titulo-contenedor">
                        <span class="material-symbols-outlined icono-titulo">school</span>
                        <h1 class="titulo-pagina">Panel de Control</h1>
                    </div>
                </div>

                <!-- Tarjetas de estadísticas -->
                <div class="estadisticas-rapidas">
                    <div class="tarjeta-estadistica card-stats">
                        <div class="contenido-estadistica">
                            <h4 class="stat-label">Total Reportes</h4>
                            <span class="numero-estadistica stat-number" id="total-reportes">0</span>
                        </div>
                        <div class="icono-estadistica">
                            <span class="material-symbols-outlined">assignment</span>
                        </div>
                    </div>
                    <div class="tarjeta-estadistica card-stats">
                        <div class="contenido-estadistica">
                            <h4 class="stat-label">Reportes Enviados</h4>
                            <span class="numero-estadistica stat-number" id="reportes-enviados">0</span>
                        </div>
                        <div class="icono-estadistica">
                            <span class="material-symbols-outlined">send</span>
                        </div>
                    </div>
                    <div class="tarjeta-estadistica card-stats">
                        <div class="contenido-estadistica">
                            <h4 class="stat-label">En Revisión</h4>
                            <span class="numero-estadistica stat-number" id="reportes-revision">0</span>
                        </div>
                        <div class="icono-estadistica">
                            <span class="material-symbols-outlined">visibility</span>
                        </div>
                    </div>
                    <div class="tarjeta-estadistica card-stats">
                        <div class="contenido-estadistica">
                            <h4 class="stat-label">En Proceso</h4>
                            <span class="numero-estadistica stat-number" id="reportes-proceso">0</span>
                        </div>
                        <div class="icono-estadistica">
                            <span class="material-symbols-outlined">sync</span>
                        </div>
                    </div>
                    <div class="tarjeta-estadistica card-stats">
                        <div class="contenido-estadistica">
                            <h4 class="stat-label">Resueltos</h4>
                            <span class="numero-estadistica stat-number" id="reportes-resueltos">0</span>
                        </div>
                        <div class="icono-estadistica">
                            <span class="material-symbols-outlined">check_circle</span>
                        </div>
                    </div>
                </div>

                <!-- Filtros de búsqueda -->
                <div class="contenedor-filtros">
                    <div class="filtros-reportes">
                        <div class="campo-busqueda">
                            <span class="material-symbols-outlined icono-buscar">search</span>
                            <input type="text" class="input-busqueda" placeholder="Buscar reportes..." id="buscarReportes">
                        </div>
                        
                        <div class="grupo-filtros">
                            <div class="filtro-categoria">
                                <label for="filtroCategoria" class="etiqueta-filtro">Categoría</label>
                                <select id="filtroCategoria" class="select-filtro">
                                    <option value="">Todas</option>
                                    <option value="infraestructura">Infraestructura</option>
                                    <option value="tecnologia">Tecnología</option>
                                    <option value="mobiliario">Mobiliario</option>
                                    <option value="servicios">Servicios</option>
                                    <option value="seguridad">Seguridad</option>
                                    <option value="limpieza">Limpieza</option>
                                    <option value="otros">Otros</option>
                                </select>
                            </div>
                            
                            <div class="filtro-estado">
                                <label for="filtroEstado" class="etiqueta-filtro">Estado</label>
                                <select id="filtroEstado" class="select-filtro">
                                    <!-- Las opciones se cargarán dinámicamente -->
                                </select>
                            </div>
                            
                            <div class="filtro-fecha">
                                <label for="filtroFecha" class="etiqueta-filtro">Fecha</label>
                                <select id="filtroFecha" class="select-filtro">
                                    <option value="">Todas</option>
                                    <option value="hoy">Hoy</option>
                                    <option value="semana">Esta semana</option>
                                    <option value="mes">Este mes</option>
                                    <option value="trimestre">Último trimestre</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Tabla de reportes -->
                <div class="contenedor-tabla">
                    <div class="encabezado-tabla">
                        <h2 class="titulo-tabla">Reportes Recientes</h2>
                    </div>
                    <div class="tabla-scroll">
                        <table class="tabla-reportes">
                            <thead class="tabla-encabezado">
                                <tr>
                                    <th class="columna-id">ID</th>
                                    <th class="columna-asunto">Asunto</th>
                                    <th class="columna-categoria">Categoría</th>
                                    <th class="columna-estado">Estado</th>
                                    <th class="columna-fecha">Fecha de Creación</th>
                                    <th class="columna-acciones">Acciones</th>
                                </tr>
                            </thead>
                            <tbody class="tabla-cuerpo" id="tabla-reportes">
                                <!-- Los reportes se cargarán dinámicamente aquí -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </main>
        </div>
        
        <!-- Indicador de carga SPA -->
        <div class="spa-loader"></div>
    </div>

    <script>
        function toggleSidebar() {
            const sidebar = document.querySelector('.sidebar');
            sidebar.classList.toggle('open');
        }

        // Cerrar sidebar al hacer clic fuera de ella en móvil
        document.addEventListener('click', function(event) {
            const sidebar = document.querySelector('.sidebar');
            const menuButton = document.querySelector('.boton-menu-movil');
            
            if (window.innerWidth <= 1024 && 
                !sidebar.contains(event.target) && 
                !menuButton.contains(event.target) && 
                sidebar.classList.contains('open')) {
                sidebar.classList.remove('open');
            }
        });
    </script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <!-- Sistema de componentes -->
    <script src="js/components.js"></script>
    <!-- Sistema de navegación SPA -->
    <script src="js/spa-navigation.js"></script>
    <script src="js/mis-reportes.js"></script>
</body>
</html>